{% extends "metdataexplorer/base.html" %}
{% load tethys_gizmos %}
{% load static %}

{% block header_buttons %}
  <div class="header-button glyphicon-button" data-toggle="tooltip" data-placement="bottom" title="Help">
    <a data-toggle="modal" data-target="#help-modal"><span class="glyphicon glyphicon-question-sign"></span></a>
  </div>
{% endblock %}

{% block groups %}
  <div>
    {% for group in groups %}
      <div >
        <div class="titles" style="width: 100%; background-color: #4532fc; margin: 5px 0px 5px 0px">
          <h3>{{ group.name }}</h3>
          <img id="add-url" class="add-button" src="{% static 'metdataexplorer/images/addButton.png' %}" style="height: 20px; width: auto">
        </div>
        <div style="width: 96%; height: 200px; background-color: white; margin: 0% 2% 0% 2%;">
          {% for thredd in thredds %}
          <div class="url-list">
            <h4>{{ thredd.name }}</h4>
          </div>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}

{% block app_content %}
  <div id="main-body">
    <div id="map"></div>
    <div id="lower-content">
      <div style="width: 50%; height: 100%; float: left;">
        <div class="half-box">
          <button id="up-file" class="fa fa-angle-double-up" style="float: left; height: 26px; width: 5%; margin: 5px 0px 10px 2%"></button>
          <input id="url-input" type="text" placeholder="Thredds URL" style="width: 86%; margin: 5px 0px 10px 0px; display: inline-block">
          <button id="save-url" class="fa fa-save" style="float: right; height: 26px; width: 5%; margin: 5px 2% 10px 0px"></button>
          <div id="filetree-div" class="inner-div"></div>
        </div>
      </div>
      <div style="width: 50%; height: 100%; float: right;">
        <div class="half-box">
          <button id="file-metadata-button" class="data-button" style="float: left;">File Metadata</button>
          <button id="var-metadata-button" class="data-button" style="float: right;">Variable Metadata</button>
          <div id="metadata-div" class="inner-div">
          </div>
          <div id="var-metadata-div" class="inner-div" style="display: none">
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{# Use the after_app_content block for modals #}
{% block after_app_content %}
  <!-- Help Modal -->
  <div class="modal fade" id="help-modal" tabindex="-1" role="dialog" aria-labelledby="help-modal-label">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="width: 26px"><span aria-hidden="true">X</span></button>
          <h5 class="modal-title" id="help-modal-label">Help</h5>
        </div>
        <div class="modal-body">
          <p>To view a dataset, enter the Thredds server url into the input bar in the
            left, bottom toolbar. Navigate to the file you want to view and select it.
            Use the rectangle tool to draw a bounding box on the map, or select a shape feature
            to get the timeseries.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Upload Shapefile -->
  <div class="modal fade" id="uploadshp-modal" tabindex="-1" role="dialog" aria-labelledby="shp-modal-label">
    <div class="modal-dialog modal-dialog-centered" role="document" style="width: 50%">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="width: 26px"><span aria-hidden="true">X</span></button>
        </div>
        <form action="" method="post" enctype="multipart/form-data">
          {% csrf_token %}
        <div class="modal-text-container">
          <h2>Upload a Shapefile</h2>
          <br>
          <div>
            <input type="file" class="local-file-upload" id="shapefile-upload"
                   style="display: inline-block" accept=".shp,.prj,.shx,.dbf," multiple>
            <button type="button" class="btn btn-success" id="uploadshp" style="width: 200px">Submit Shapefile</button>
          </div>
          <div>
            <br>
            <p>
              Select four files with the endings '.shp', '.shx', '.prj', and '.dbf'.
            </p>
          </div>
        </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Timeseries -->
  <div class="modal fade" id="timeseries-model" tabindex="-1" role="dialog" aria-labelledby="shp-modal-label">
    <div class="modal-dialog modal-dialog-centered" role="document" style="width: 50%">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" style="width: 30%; float: left" id="download-csv">Download CSV</button>
          <button type="button" style="width: 10%" class="close" data-dismiss="modal" aria-label="Close" ><span aria-hidden="true">X</span></button>
        </div>
        <div id="point_plot" style="width: 80%; height: 80%;"></div>
        <div id="chart"></div>
      </div>
    </div>
  </div>

  <!-- Add Group -->
  <div class="modal fade" id="add-group-model" tabindex="-1" role="dialog" aria-labelledby="shp-modal-label">
    <div class="modal-dialog modal-dialog-centered" role="document" style="width: 50%; height: auto">
      <div class="modal-content">
        <div class="modal-header">
          <div style="display: flex; align-items: center; justify-content: center;">
            <div style="width: 95%;">
              <h2 style="float: left">Add a Group of Thredds Data Servers</h2>
              <button type="button" style="width: 10%; float: right" class="close" data-dismiss="modal" aria-label="Close" ><span aria-hidden="true">X</span></button>
            </div>
          </div>
        </div>
        <div style="display: flex; align-items: center; justify-content: center;">
          <div style="width: 90%; height: auto">
            <label for="group-title-input" style="float: left">Title (Required):</label>
            <input id="group-title-input" class="inputsty">
            <label for="group-description-input" style="float: left">Description (Required):</label>
            <textarea id="group-description-input"></textarea>
          </div>
        </div>
        <div>
          <button id="add-group-submit" style="width: 100px; float: right;">Add</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Thredds URL -->
  <div class="modal fade" id="add-thredds-model" tabindex="-1" role="dialog" aria-labelledby="shp-modal-label">
    <div class="modal-dialog modal-dialog-centered" role="document" style="width: 50%; height: auto">
      <div class="modal-content">
        <div class="modal-header">
          <div style="display: flex; align-items: center; justify-content: center;">
            <div style="width: 95%;">
              <h2 style="float: left">Add a Thredds URL</h2>
              <button type="button" style="width: 10%; float: right" class="close" data-dismiss="modal" aria-label="Close" ><span aria-hidden="true">X</span></button>
            </div>
          </div>
        </div>
        <div style="display: flex; align-items: center; justify-content: center;">
          <div style="width: 90%; height: auto">
            <label for="thredds-title-input" style="float: left">Title (Required):</label>
            <input id="thredds-title-input" class="inputsty">
            <label for="thredds-url-input" style="float: left">URL (Required):</label>
            <input id="thredds-url-input" class="inputsty">
            <label for="thredds-tags-input" style="float: left">Tags:</label>
            <input id="thredds-tags-input" class="inputsty">
            <label for="thredds-map-input" style="float: left">Spatial Extents:</label>
            <input id="thredds-map-input" class="inputsty">
            <label for="thredds-description-input" style="float: left;">Description (Required):</label>
            <textarea id="thredds-description-input" style="width: 100%; height: 200px"></textarea>
          </div>
        </div>
        <div>
          <button id="add-thredds-submit" style="width: 100px; float: right;">Add</button>
        </div>
      </div>
    </div>
  </div>

  <!-- loading -->
  <div class="modal fade" id="loading-model" tabindex="-1" role="dialog" aria-labelledby="shp-modal-label">
    <div class="loader"></div>
  </div>
{% endblock %}

{% block app_actions %}

{% endblock %}